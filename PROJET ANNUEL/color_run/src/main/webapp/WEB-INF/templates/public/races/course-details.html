<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="'Color Run – ' + ${course.nom}">Détail course</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body class="bg-gray-100">

<div class="max-w-7xl mx-auto px-4 py-8">

    <!-- ===== en-tête image ===== -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden mb-8">
        <div class="h-96 bg-gradient-to-r from-purple-400 to-pink-400 relative">
            <div class="absolute bottom-0 left-0 right-0 p-8
                  bg-gradient-to-t from-black/80 to-transparent">
                <h1 class="text-4xl font-bold text-white mb-2"
                    th:text="${course.nom}">Color Run</h1>

                <div class="flex flex-wrap items-center text-white space-x-6">
          <span class="flex items-center">
            <i class="fas fa-calendar-alt mr-2"></i>
            <span th:text="${#temporals.format(course.date,'dd MMMM yyyy', 'fr')}">
              15 juin 2025
            </span>
          </span>
                    <span class="flex items-center">
            <i class="fas fa-map-marker-alt mr-2"></i>
            <span th:text="${course.lieu}">Paris</span>
          </span>
                    <span class="flex items-center" th:if="${course.distance != null}">
            <i class="fas fa-running mr-2"></i>
            <span th:text="${course.distance + ' km'}">5&nbsp;km</span>
          </span>
                </div>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

        <!-- ===== COLONNE PRINCIPALE (2/3) ===== -->
        <div class="lg:col-span-2 space-y-8">

            <!-- Description -->
            <section class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold mb-4">À propos de la course</h2>
                <p class="text-gray-600 mb-4"
                   th:text="${course.description}">
                    Rejoignez-nous pour…
                </p>

                <div class="grid grid-cols-2 gap-4 mt-6 text-gray-600">
                    <div class="flex items-center" th:if="${course.nombreMaxParticipants != null}">
                        <i class="fas fa-users text-purple-600 mr-2"></i>
                        <span th:text="'Max participants : ' + ${course.nombreMaxParticipants}">
              Max participants : 1000
            </span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-euro-sign text-purple-600 mr-2"></i>
                        <span th:text="'Prix : ' +
                           ${#numbers.formatDecimal(course.prix,1,'POINT',2,'POINT')} + ' €'">
              Prix : 25 €
            </span>
                    </div>
                </div>
            </section>

            <!-- Carte / Itinéraire -->
            <section class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold mb-4">Itinéraire</h2>
                <div id="map" class="h-96 rounded-lg">
                    <!-- Map JS ou iframe -->
                </div>
            </section>

            <!-- FAQ -->
            <section class="bg-white rounded-lg shadow-md p-6"
                     th:if="${faqBlocks != null}">
                <h2 class="text-2xl font-semibold mb-6">FAQ – Course</h2>
                <div class="space-y-6">
                    <div th:each="f : ${faqBlocks}">
                        <h3 class="text-lg font-medium text-purple-600 mb-2"
                            th:text="${f.question}">Question ?</h3>
                        <p class="text-gray-600" th:text="${f.reponse}">Réponse…</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- ===== SIDEBAR (1/3) ===== -->
        <aside class="space-y-8">

            <!-- Encadré inscription -->
            <section class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold mb-4">Inscription</h2>

                <div class="space-y-4 text-gray-700">
                    <div class="flex justify-between">
                        <span>Prix d'inscription</span>
                        <span class="text-2xl font-bold text-purple-600"
                              th:text="${#numbers.formatDecimal(course.prix,1,'POINT',2,'POINT')} + ' €'">
              25 €
            </span>
                    </div>
                    <div class="flex justify-between" th:if="${placesDispo != null}">
                        <span>Places disponibles</span>
                        <span th:text="${placesDispo}">850</span>
                    </div>
                </div>

                <!-- Bouton pour afficher le formulaire -->
                <button id="registerButton"
                        class="w-full mt-6 bg-purple-600 text-white px-4 py-3 rounded-md
                       hover:bg-purple-700 focus:outline-none"
                        type="button">
                    S'inscrire maintenant
                </button>

                <!-- Formulaire d’inscription caché -->
                <form id="registrationForm" th:action="@{'/courses/' + ${course.id} + '/register'}"
                      method="post" class="hidden mt-6 space-y-4"
                      th:object="${participantForm}">

                    <!-- Exemple de champs -->
                    <input type="text" th:field="*{prenom}"  placeholder="Prénom"  class="input"/>
                    <input type="text" th:field="*{nom}"     placeholder="Nom"     class="input"/>
                    <input type="email" th:field="*{email}"  placeholder="Email"   class="input"/>
                    <input type="tel"   th:field="*{phone}"  placeholder="Téléphone" class="input"/>

                    <!-- Paiement via Stripe plus tard -->

                    <button type="submit"
                            class="w-full bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700">
                        Valider l'inscription
                    </button>
                </form>
            </section>

            <!-- Section Chat ou autres widgets -->
            <section class="bg-white rounded-lg shadow-md p-6">
                <!-- … chat … -->
            </section>
        </aside>
    </div>
</div>

<script>
    /* Exemple rapide pour afficher/masquer le formulaire inscription */
    document.addEventListener('DOMContentLoaded', () => {
        const btn  = document.getElementById('registerButton');
        const form = document.getElementById('registrationForm');
        if (btn && form) {
            btn.addEventListener('click', () => form.classList.toggle('hidden'));
        }
    });
</script>
<a th:href="@{/}"
   class="inline-flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-md
              hover:bg-purple-700 transition">
    Retour
</a>
</body>
</html>
